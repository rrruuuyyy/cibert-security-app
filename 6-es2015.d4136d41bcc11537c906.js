(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{t5pA:function(t,i,e){"use strict";e.r(i),e.d(i,"ConfigModule",(function(){return L}));var n=e("3Pt+"),o=e("ofXK"),s=e("334H"),a=e("1jcm"),r=e("tyNb");class c{constructor(t){this.name=t.name,this.email=t.email,this.role=t.role,this.id=t.id,this.config=t.config}}class b{constructor(t){this.dashboard=t}}var d=e("Vh/8"),h=e("9v22"),l=e("fXoL"),p=e("1kSV"),u=e("kmnG"),f=e("qFsG"),g=e("d3UM"),v=e("FKr1");function m(t,i){1&t&&(l.Vb(0,"h3"),l.Gc(1,"Add"),l.Ub())}function V(t,i){1&t&&(l.Vb(0,"h3"),l.Gc(1,"Edit"),l.Ub())}function U(t,i){if(1&t){const t=l.Wb();l.Vb(0,"tr"),l.Vb(1,"td"),l.Gc(2),l.Ub(),l.Vb(3,"td"),l.Gc(4),l.Ub(),l.Vb(5,"td"),l.Vb(6,"i",24),l.hc("click",(function(){l.yc(t);const e=i.index;return l.jc().edit(e)})),l.Ub(),l.Vb(7,"i",25),l.hc("click",(function(){l.yc(t);const e=i.index;return l.jc().delet(e)})),l.Ub(),l.Ub(),l.Ub()}if(2&t){const t=i.$implicit;l.Bb(2),l.Hc(t.label),l.Bb(2),l.Hc(t.y)}}let w=(()=>{class t{constructor(t,i){this.modalService=t,this.fb=i,this.canvas=null,this.back=new l.n,this.type="",this.title="",this.prefix="",this.render=!0,this.options={subtitles:[{text:this.title}],height:200,animationEnabled:!0,data:[{type:"pie",startAngle:40,toolTipContent:"<b>{label}</b>: {y}"+this.prefix,showInLegend:!1,legendText:"{label}",indexLabel:"{label} - {y}"+this.prefix,dataPoints:[]}]},this.editando=!1,this.form=this.fb.group({label:["",n.r.required],y:["",n.r.required]})}changePrefix(){this.options.data[0].toolTipContent="<b>{label}</b>: {y}"+this.prefix,this.options.data[0].indexLabel="{label} - {y}"+this.prefix,$("#chart_preview").CanvasJSChart(this.options),console.log(this.options)}onClick(){}add(){this.form.invalid?d.a.fire("Fill all","","error"):(this.editando?(this.options.data[0].dataPoints[this.index]=this.form.value,this.editando=!1):this.options.data[0].dataPoints.push(this.form.value),this.form.reset(),$("#chart_preview").CanvasJSChart(this.options))}edit(t){this.index=t,this.form.patchValue(this.options.data[0].dataPoints[t]),this.editando=!0}delet(t){this.options.data[0].dataPoints.splice(t,1),$("#chart_preview").CanvasJSChart(this.options)}save(){0!==this.options.data[0].dataPoints.length?this.back.emit(this.options):d.a.fire("Graphics whitout data","","error")}ngOnInit(){this.canvas?(this.options=this.canvas,setTimeout(()=>{this.render=!1,$("#chart_preview").CanvasJSChart(this.options)},50)):this.render=!1}}return t.\u0275fac=function(i){return new(i||t)(l.Pb(p.a),l.Pb(n.c))},t.\u0275cmp=l.Jb({type:t,selectors:[["app-canvas-creator"]],inputs:{canvas:"canvas"},outputs:{back:"back"},decls:45,vars:6,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","row"],[1,"col-12","text-center"],[4,"ngIf"],[1,"col-10"],["matInput","","placeholder","Title",3,"ngModel","ngModelChange"],["placeholder","Selec type canvas",1,"col-2",3,"ngModel","ngModelChange","change"],["value",""],["value","%"],["value","$"],[1,"col-12","row",3,"formGroup"],[1,"col-6","form-group"],["formControlName","label","matInput","","placeholder","Label"],["formControlName","y","type","number","matInput","","placeholder","Value"],[1,"col-12","text-center","form-group"],[1,"btn","btn-info",3,"click"],[1,"col-12"],["id","chart_preview",2,"height","200px","width","100%"],[1,"table"],[4,"ngFor","ngForOf"],[1,"fa","fa-edit","pointer",3,"click"],[1,"fa","fa-trash","pointer",2,"margin-left","5px",3,"click"]],template:function(t,i){1&t&&(l.Vb(0,"div",0),l.Vb(1,"div",1),l.Vb(2,"h5",2),l.Gc(3,"Canvas creator"),l.Ub(),l.Vb(4,"button",3),l.hc("click",(function(){return i.modalService.dismissAll()})),l.Vb(5,"span",4),l.Gc(6,"\xd7"),l.Ub(),l.Ub(),l.Ub(),l.Vb(7,"div",5),l.Vb(8,"div",6),l.Ec(9,m,2,0,"h3",7),l.Ec(10,V,2,0,"h3",7),l.Ub(),l.Vb(11,"mat-form-field",8),l.Vb(12,"input",9),l.hc("ngModelChange",(function(t){return i.options.subtitles[0].text=t})),l.Ub(),l.Ub(),l.Vb(13,"mat-select",10),l.hc("ngModelChange",(function(t){return i.prefix=t}))("change",(function(){return i.changePrefix()})),l.Vb(14,"mat-option",11),l.Gc(15,"None"),l.Ub(),l.Vb(16,"mat-option",12),l.Gc(17,"%"),l.Ub(),l.Vb(18,"mat-option",13),l.Gc(19,"$"),l.Ub(),l.Ub(),l.Vb(20,"div",14),l.Vb(21,"mat-form-field",15),l.Qb(22,"input",16),l.Ub(),l.Vb(23,"mat-form-field",15),l.Qb(24,"input",17),l.Ub(),l.Ub(),l.Vb(25,"div",18),l.Vb(26,"button",19),l.hc("click",(function(){return i.add()})),l.Gc(27,"Add"),l.Ub(),l.Ub(),l.Vb(28,"div",20),l.Qb(29,"div",21),l.Ub(),l.Vb(30,"div",20),l.Vb(31,"table",22),l.Vb(32,"thead"),l.Vb(33,"tr"),l.Vb(34,"th"),l.Gc(35,"Label"),l.Ub(),l.Vb(36,"th"),l.Gc(37,"Value"),l.Ub(),l.Vb(38,"th"),l.Gc(39,"Acctions"),l.Ub(),l.Ub(),l.Ub(),l.Vb(40,"tbody"),l.Ec(41,U,8,2,"tr",23),l.Ub(),l.Ub(),l.Ub(),l.Vb(42,"div",6),l.Vb(43,"button",19),l.hc("click",(function(){return i.save()})),l.Gc(44,"Save"),l.Ub(),l.Ub(),l.Ub(),l.Ub()),2&t&&(l.Bb(9),l.oc("ngIf",!i.editando),l.Bb(1),l.oc("ngIf",i.editando),l.Bb(2),l.oc("ngModel",i.options.subtitles[0].text),l.Bb(1),l.oc("ngModel",i.prefix),l.Bb(7),l.oc("formGroup",i.form),l.Bb(21),l.oc("ngForOf",i.options.data[0].dataPoints))},directives:[o.k,u.b,f.a,n.b,n.j,n.m,g.a,v.j,n.k,n.e,n.d,n.o,o.j],styles:[""]}),t})();var x=e("PSD3"),C=e.n(x),y=e("kt0X"),k=e("0np6"),G=e("tk/3");let _=(()=>{class t{constructor(t){this.http=t,this.url=k.b}editConfig(t,i){return this.http.put(this.url+`usuario/${t}/config`,i,this.auth())}auth(){let t=localStorage.getItem("token");return{headers:new G.d({"Content-Type":"application/json",Authorization:"Bearer "+t})}}}return t.\u0275fac=function(i){return new(i||t)(l.dc(G.b))},t.\u0275prov=l.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var S=e("eaKD");function Q(t,i){1&t&&(l.Vb(0,"div",15),l.Vb(1,"div",16),l.Qb(2,"div"),l.Qb(3,"div"),l.Qb(4,"div"),l.Qb(5,"div"),l.Qb(6,"div"),l.Qb(7,"div"),l.Qb(8,"div"),l.Qb(9,"div"),l.Ub(),l.Vb(10,"h4"),l.Gc(11,"Rendering, please wait..."),l.Ub(),l.Ub())}function I(t,i){if(1&t){const t=l.Wb();l.Vb(0,"div",17),l.Vb(1,"i",18),l.hc("click",(function(){l.yc(t);const e=i.index;return l.jc().openModal(e)})),l.Ub(),l.Vb(2,"i",19),l.hc("click",(function(){l.yc(t);const e=i.index;return l.jc().delete(e)})),l.Ub(),l.Qb(3,"div",20),l.Ub()}if(2&t){const t=i.index,e=l.jc();l.oc("hidden",e.getting_graphics),l.Bb(3),l.qc("id","",t,"_canvas")}}function B(t,i){1&t&&(l.Vb(0,"div",21),l.Vb(1,"strong"),l.Gc(2,"Sin graficas"),l.Ub(),l.Ub())}function P(t,i){1&t&&(l.Vb(0,"div",22),l.Vb(1,"div",15),l.Vb(2,"div",16),l.Qb(3,"div"),l.Qb(4,"div"),l.Qb(5,"div"),l.Qb(6,"div"),l.Qb(7,"div"),l.Qb(8,"div"),l.Qb(9,"div"),l.Qb(10,"div"),l.Ub(),l.Vb(11,"h4"),l.Gc(12,"Saving configuration, please wait..."),l.Ub(),l.Ub(),l.Ub())}let j=(()=>{class t{constructor(t,i,e,n,o){this.fb=t,this.store=i,this._configService=e,this.modalService=n,this._graphicsService=o,this.config=null,this.usuario=null,this.saving_config=!1,this.getting_graphics=!0,this.graphics=[],this.options=[],this.form=this.fb.group({information_panel:!1})}ngOnInit(){this.store.select("usuario").subscribe(t=>{t&&(this.usuario=t,this.form.patchValue({information_panel:this.usuario.config.dashboard.information_panel}),this.obtenerGraficas())})}openModal(t=null){const i=this.modalService.open(w,{size:"lg"});i.componentInstance.canvas=null!=t?this.options[t]:null,i.componentInstance.back.subscribe(i=>{this.modalService.dismissAll(),d.a.fire("Saving changes","","info"),null!=t?this.options[t]=i:this.options.push(i),this._graphicsService.editCanvas({section:"dashboard",data:this.options}).subscribe(t=>{d.a.fire(t.mensaje,"","success")}),this.renderizar()})}obtenerGraficas(){this.getting_graphics=!0,this._graphicsService.getCanvasBySection("dashboard").subscribe(t=>{t.status?(this.options=t.data.data,this.renderizar()):d.a.fire(t.mensaje,"","error"),this.getting_graphics=!1})}renderizar(){setTimeout(()=>{this.graphics=[];for(let t=0;t<this.options.length;t++)$(`#${t}_canvas`),this.graphics.push($(`#${t}_canvas`).CanvasJSChart(this.options[t]))},100)}delete(t){C.a.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(i=>{d.a.fire("Uploading changes","","success"),this.options.splice(t,1),this._graphicsService.editCanvas({section:"dashboard",data:this.options}).subscribe(t=>{d.a.fire(t.mensaje,"","success"),this.renderizar()})})}updateConfig(){const t=new b(this.usuario.config.dashboard);t.dashboard=this.form.value,this.saving_config=!0,this._configService.editConfig(this.usuario.id,t).subscribe(t=>{if(t.status){let i=new c(this.usuario);i.config=t.data,this.store.dispatch(new h.b(i)),d.a.fire("Config update","","success")}this.saving_config=!1})}}return t.\u0275fac=function(i){return new(i||t)(l.Pb(n.c),l.Pb(y.h),l.Pb(_),l.Pb(p.a),l.Pb(S.a))},t.\u0275cmp=l.Jb({type:t,selectors:[["app-config-dashboard"]],decls:22,vars:7,consts:[[1,"row",3,"formGroup","hidden"],[1,"col-6"],[1,"title"],[1,"card-subtitle"],["formControlName","information_panel"],[1,"col-12","text-center"],[1,"btn","btn-info",3,"click"],[1,"col-12","centrado","row",2,"padding-top","10px","margin-top","10px","border-top","1px solid black"],[1,"col-3"],[1,"col-2"],["class","col-md-12 text-center","style","margin-top: 20px",4,"ngIf"],["class","col-4","style","height: 220px; width: 100%;",3,"hidden",4,"ngFor","ngForOf"],[1,"row",3,"hidden"],["class","alert alert-primary","role","alert","class","col-12 row",4,"ngIf"],["class","",4,"ngIf"],[1,"col-md-12","text-center",2,"margin-top","20px"],[1,"lds-roller"],[1,"col-4",2,"height","220px","width","100%",3,"hidden"],[1,"fa","fa-edit","pointer",3,"click"],[1,"fa","fa-trash","pointer",2,"margin-left","10px",3,"click"],[2,"height","220px","width","100%",3,"id"],["role","alert",1,"col-12","row"],[1,""]],template:function(t,i){1&t&&(l.Vb(0,"div",0),l.Vb(1,"div",1),l.Vb(2,"p",2),l.Gc(3,"Show informative tables"),l.Ub(),l.Vb(4,"p",3),l.Gc(5,"Tables with information up to date about computer attacks and vulnerabilities"),l.Ub(),l.Qb(6,"mat-slide-toggle",4),l.Ub(),l.Vb(7,"div",5),l.Vb(8,"button",6),l.hc("click",(function(){return i.updateConfig()})),l.Gc(9,"Save"),l.Ub(),l.Ub(),l.Vb(10,"div",7),l.Vb(11,"div",8),l.Vb(12,"h3"),l.Gc(13,"Graficas Dashboard"),l.Ub(),l.Ub(),l.Vb(14,"div",9),l.Vb(15,"button",6),l.hc("click",(function(){return i.openModal()})),l.Gc(16,"New"),l.Ub(),l.Ub(),l.Ub(),l.Ec(17,Q,12,0,"div",10),l.Ec(18,I,4,2,"div",11),l.Qb(19,"div",12),l.Ec(20,B,3,0,"div",13),l.Ub(),l.Ec(21,P,13,0,"div",14)),2&t&&(l.oc("formGroup",i.form)("hidden",i.saving_config),l.Bb(17),l.oc("ngIf",i.getting_graphics),l.Bb(1),l.oc("ngForOf",i.options),l.Bb(1),l.oc("hidden",i.getting_graphics),l.Bb(1),l.oc("ngIf",0===i.options.length&&!i.getting_graphics),l.Bb(1),l.oc("ngIf",i.saving_config))},directives:[n.k,n.e,a.a,n.j,n.d,o.k,o.j],styles:[""]}),t})();var M=e("MutI"),A=e("f0Cb");const J=function(){return["dashboard"]},T=function(t){return{active_submenu:t}};let E=(()=>{class t{constructor(t,i){this.router=t,this.location=i,this.hrefs=[]}ngOnInit(){this.hrefs=this.router.url.split("/");for(let t=0;t<this.hrefs.length;t++)""===this.hrefs[t]&&this.hrefs.splice(t,1);this.router.events.subscribe(t=>{if(""!=this.location.path()){var i=this.location.path();this.hrefs=i.split("/");for(let t=0;t<this.hrefs.length;t++)""!=this.hrefs[t]&&this.hrefs.splice(t,1)}})}}return t.\u0275fac=function(i){return new(i||t)(l.Pb(r.a),l.Pb(o.g))},t.\u0275cmp=l.Jb({type:t,selectors:[["app-config-header"]],decls:9,vars:5,consts:[[1,"pointer",3,"routerLink","ngClass"],[1,"pointer"]],template:function(t,i){1&t&&(l.Vb(0,"mat-list"),l.Vb(1,"mat-list-item",0),l.Gc(2,"Dashboard"),l.Ub(),l.Qb(3,"mat-divider"),l.Vb(4,"mat-list-item",1),l.Gc(5,"Alerts"),l.Ub(),l.Qb(6,"mat-divider"),l.Vb(7,"mat-list-item",1),l.Gc(8,"Active domains"),l.Ub(),l.Ub()),2&t&&(l.Bb(1),l.oc("routerLink",l.rc(2,J))("ngClass",l.sc(3,T,"dashboard"===i.hrefs[1])))},directives:[M.a,M.b,r.b,o.i,A.a],styles:[".active_submenu[_ngcontent-%COMP%]{background-color:#bfb8ad}"]}),t})();const F=r.c.forChild([{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=l.Jb({type:t,selectors:[["app-config"]],decls:10,vars:0,consts:[[1,"main","container-body-submenu"],[1,"body-left"],[1,"body-rigth"],[1,"card"],[1,"card-header","bg-color"],[1,"m-b-0","text-white"],[1,"card-body"]],template:function(t,i){1&t&&(l.Vb(0,"div",0),l.Vb(1,"div",1),l.Qb(2,"app-config-header"),l.Ub(),l.Vb(3,"div",2),l.Vb(4,"div",3),l.Vb(5,"div",4),l.Vb(6,"h4",5),l.Gc(7,"Config - dashboard"),l.Ub(),l.Ub(),l.Vb(8,"div",6),l.Qb(9,"router-outlet"),l.Ub(),l.Ub(),l.Ub(),l.Ub())},directives:[E,r.d],styles:[""]}),t})(),children:[{path:"dashboard",component:j},{path:"**",redirectTo:"dashboard"}]},{path:"**",redirectTo:""}]);let L=(()=>{class t{}return t.\u0275mod=l.Nb({type:t}),t.\u0275inj=l.Mb({factory:function(i){return new(i||t)},providers:[],imports:[[o.b,F,n.f,n.p,s.a,a.b,u.d,g.b,f.b]]}),t})()}}]);